---
title: "Lady Tasting Tea Lineups for Visual Inference"
author: "Karsten Maurer"
# institute: "Miami University"
date: "July 31, 2019"
output:
  xaringan::moon_reader:
    css: [default, "Miami_theme.css"]
    lib_dir: libs
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


<style>
  .col2 {
    columns: 2 200px;         /* number of columns and width in pixels*/
    -webkit-columns: 2 200px; /* chrome, safari */
    -moz-columns: 2 200px;    /* firefox */
  }
  .col3 {
    columns: 3 100px;
    -webkit-columns: 3 100px;
    -moz-columns: 3 100px;
  }
</style>


### Lady Tasting Tea <sup>1</sup>

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(teaTasteR)
```


```{r, out.width = "320px", echo=FALSE}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Nice_Cup_of_Tea.jpg/1280px-Nice_Cup_of_Tea.jpg")
```

.footnote[
[1] Fisher, R. A. (1960)
]

- Ronald Fisher and Muriel Bristol working at Rothamsted

- Claimed she could tell if tea or milk added first

--
- Blind taste test: four milk first, four tea first

- Fisher's Exact Test  $\rightarrow$ follows hypergeometric if guessing


???

Image credit: [Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Sharingan_triple.svg)

---
### Lineups 

```{r, echo=FALSE, fig.align='center', out.height=380, fig.cap='Can the witness pick the criminal out of a randomized lineup of people?'}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/0/04/Oppstilling-2.jpg")
```

???

Image credit: [Wikimedia Commons](https://upload.wikimedia.org/wikipedia/commons/0/04/Oppstilling-2.jpg)

---
### Lineups (for Visual Inference) <sup>2</sup>

.footnote[
[2] Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E. K., Swayne, D. F., & Wickham, H. (2009)
]

```{r, echo=FALSE, fig.align='center', fig.width=9, fig.height=6, out.height=380,out.width=570,  cache=TRUE, fig.cap='Can the statistician pick the real data out of a randomized lineup of data simulated under the null?'}
set.seed(12345)
M=19
diamond_samp <- sample_n(diamonds,500)
order_types = sample(c(rep("null",  M),"real"), M+1)
dat_stacked = NULL
    for (i in 1:(M+1)) {
        if (order_types[i] == "null"){
          dat_i = make_null_dat(dat=diamond_samp,xname = "carat",yname="price")
        }  
        if (order_types[i] == "real"){
          dat_i = data.frame(x=diamond_samp$carat,
                             permy=diamond_samp$price,
                             type="real")
        } 
        dat_i$order = i
        dat_stacked = rbind(dat_stacked, dat_i)
    }   
tt_lineup_plot(dat_stacked) +
  theme(panel.spacing = unit(.2, "lines"),
        strip.text=element_text(size=14))
```
---

### Lineups (for Visual Inference)

- Plot of real data hidden in set of K-1 plots of data generated under null model
<br><br>

--
#### Lineup Interpretations - One Viewer

- If a viewer can pick out the real data (p-value=1/K) $\rightarrow$ reject the null

- If a viewer can't pick out the real data (p-value=1) $\rightarrow$ fail to reject the null
<br><br>

--
#### Lineup Interpretations - Many Viewers

- Each person attempts to pick out real data

- Sum of correct guesses distributed Binomial(n,1/K) if viewers independent

---

### Our Work

- Research Team: George Woodbury, Seonjin Kim and myself

- Work started with George's masters project improving visual inference with one person

- After masters, George came back with a new idea...

-- 
#### Mashup: Tea Tasting + Lineup Plots

- Applying experimental design from the lady tasting tea

- Randomized lineup of with multiple null and *multiple* target plots

- Viewer (*tea-taster*) tasked with identifying target plots

???

"The Lady Tasting Tea" by David Salsburg
---
class: center, middle

# Methods

```{r, include=FALSE}
#------------------------------------
### make plot building walkthrough with faithful data

set.seed(123)
examplePlotBuild1 <- faithful %>%
  mutate(type="Original") %>%
  sample_n(100)%>%
  select(eruptions,waiting,type)

examplePlotBuild2 <- examplePlotBuild1 %>%
  mutate(type="LOESS Fitted")%>%
  mutate(type = factor(type,levels=c("Original","LOESS Fitted","Residuals Permuted")))%>%
  select(eruptions,waiting,type)

set.seed(123)
examplePlotBuild3 <- examplePlotBuild1 %>%
  make_alt_dat(xname="waiting",yname="eruptions") %>%
  mutate(type="Residuals Permuted") %>%
  mutate(waiting=x, 
         eruptions=permy)%>%
  select(waiting,eruptions,type)

examplePlotBuild4 <- examplePlotBuild3 %>%
  mutate(type="Target Plot")


examplePlotBuild2alt <- examplePlotBuild2 %>% 
  mutate(type="LOESS Fit then Residuals Permuted",
         type=factor(type,levels=c("Original","LOESS Fit then Residuals Permuted","Target Plot")))
exampleTargetPlotBuild <- rbind(examplePlotBuild1,examplePlotBuild2alt,examplePlotBuild4) %>%
  mutate(type = factor(type,levels=c("Original","LOESS Fit then Residuals Permuted","Target Plot")),
         plottype = "Target Plot Construction", 
         permx=NA,permy=NA)
exampleTargetPlotBuild$permx[exampleTargetPlotBuild$type == "LOESS Fit then Residuals Permuted"] <- examplePlotBuild4$waiting
exampleTargetPlotBuild$permy[exampleTargetPlotBuild$type == "LOESS Fit then Residuals Permuted"] <- examplePlotBuild4$eruptions

# permute the x and y to get final plot
exampleNullPlotBuild3 <- examplePlotBuild1 %>%
  make_null_dat(xname="waiting",yname="eruptions") %>%
  mutate(type="Null Plot") %>%
  mutate(waiting=x,
         eruptions=permy)%>%
  select(waiting,eruptions,type)

# add dataset to visualize this permutation in between by adding together original (x,y) and new (x,y) columns
exampleNullPlotBuild2 <- examplePlotBuild1 %>%
  mutate(type="Permutation")
# nulldat <- data.frame(waiting=NA,eruptions=NA,type="No More")

exampleNullPlotBuild <- rbind(examplePlotBuild1,exampleNullPlotBuild2,exampleNullPlotBuild3) %>%
  mutate(type = factor(type,levels=c("Original","Permutation","Null Plot")),
         plottype = "Null Plot Construction",
         permx=NA,permy=NA)
exampleNullPlotBuild$permx[exampleNullPlotBuild$type == "Permutation"] <- exampleNullPlotBuild3$waiting
exampleNullPlotBuild$permy[exampleNullPlotBuild$type == "Permutation"] <- exampleNullPlotBuild3$eruptions

```

---
### Generating Null Plots for Tea-Tasting Lineups

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=10,fig.height=7, cache=TRUE}
p2 <- ggplot() +
  geom_point(aes(x=waiting,y=eruptions), data=exampleNullPlotBuild) +
  geom_segment(aes(x=waiting,y=eruptions, xend=permx, yend=permy),data=exampleNullPlotBuild,
               arrow = arrow(length = unit(0.2,"cm")), alpha=.2) +
  scale_y_continuous(position = "right")+
  facet_grid(plottype~type, scales="free_x", switch="y") +
  theme_bw()+
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        strip.text = element_text(size=12))

ggsave(file="MakingNullPlots.png",dpi=600,
       width=10, height=5,units="in")

knitr::include_graphics("MakingNullPlots.png")

```

---
### Generating Target Plots for Tea-Tasting Lineups

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=10,fig.height=7, cache=TRUE}
p1 <- ggplot() +
  geom_point(aes(x=waiting,y=eruptions), data=exampleTargetPlotBuild) +
  geom_segment(aes(x=waiting,y=eruptions, xend=permx, yend=permy),data=exampleTargetPlotBuild,
               arrow = arrow(length = unit(0.2,"cm")), alpha=.2) +
  facet_grid(plottype~type, scales="free_x", switch="y") +
  scale_y_continuous(position = "right")+
  stat_smooth(aes(x=waiting,y=eruptions), data=examplePlotBuild2alt, se=F) +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        strip.text = element_text(size=12))

ggsave(file="MakingTargetPlots.png",dpi=600,
       width=10, height=5,units="in")

knitr::include_graphics("MakingTargetPlots.png")
```

---
### Example Tea Tasting Lineup

```{r,echo=FALSE,fig.width=9, fig.height=6, out.height=500,out.width=750, fig.align='center', cache=TRUE}
p4 <- tt_lineup_plot(make_lineup_dat(M=8, dat=sample_n(faithful,50), xname="waiting", yname="eruptions", seed=12345))+
  theme(panel.spacing = unit(.2, "lines"),
        strip.text=element_text(size=14))

ggsave(file="faithful_lineup.png",dpi=600,
       width=9, height=6,units="in")

knitr::include_graphics("faithful_lineup.png")
```

---
### Properties

- Looks similar to traditional lineup for visual inference but task different

- p-values for single TT lineup evaluation are no longer binary

- p-values follow hypergeometric *if null and target plots indistinguishable for data generated by the null*

--

### Open Questions

#### 1. Does the TT lineup have discriminative power in practice?

--


#### 2. Are correct guess counts hypergeometrically distributed for a true null?

---
### Survey

- Participants presented with eight TT lineups based on eight datasets 

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8, fig.height=4, cache=TRUE}
# Set parameters for lineup and individual
cor_val=.9
participant_number = 1
M_pairs = 8

# load/simulate data here
library(mvtnorm)
n=50
set.seed(participant_number)
survey_order=sample(1:8)
sim_data <- list(NULL)
set.seed(2345)
sim_data[[1]] <- as.data.frame(mvtnorm::rmvnorm(n, mean=c(0,0), sigma=matrix(c(1,.6,.6,1),nrow=2,byrow=TRUE)))
sim_data[[2]] <- as.data.frame(mvtnorm::rmvnorm(n, mean=c(0,0), sigma=matrix(c(1,.3,.3,1),nrow=2,byrow=TRUE)))
sim_data[[3]] <- sim_curve(n=n, b0=0, b1=0, b2=.5, sd=2.6, range=c(-3,3))
sim_data[[4]] <- sim_curve(n=n, b0=0, b1=0, b2=.5, sd=1.4, range=c(-3,3))
sim_data[[5]] <- sample_n(faithful,n)
sim_data[[6]] <- sample_n(select(diamonds,carat,price),n)
sim_data[[7]] <- data.frame(x=rnorm(n), y=rnorm(n))
sim_data[[8]] <- data.frame(x=runif(n), y=runif(n))

simtype = c("Strong Linear","Weak Linear","Curved Weak","Curved Strong",
            "Old Faithful","Diamonds","Independent-Normal","Independent-Uniform")


for(i in 1:8){
  names(sim_data[[i]]) <- c("x","y")
  sim_data[[i]]$simtype <- simtype[i]
}

survey_dat <- do.call(rbind,sim_data) %>%
  mutate(simtype = factor(simtype, levels=c("Independent-Normal","Weak Linear","Strong Linear","Diamonds",
                                           "Independent-Uniform","Curved Weak","Curved Strong","Old Faithful")))

p5 <- ggplot() +
  geom_point(aes(x,y), data=survey_dat) +
  facet_wrap(~simtype, nrow=2, scales = "free") +
  theme_bw()+
  theme(axis.ticks = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank(),
        panel.grid = element_blank())

ggsave(file="survey_data.png",dpi=600,
       width=10, height=5,units="in")

knitr::include_graphics("survey_data.png")
```

---
### Survey

- Administration:

  + distributed to students and faculty of Miami University Stat Department
  + Anonymous drop-box for return

--
<br>

- Content
 
 + Tea-tasting lineups from 8 different datasets
 + Each lineup had 8 null plots and 8 target plots
  
--
<br> 

- Randomization: 

  + Datasets uniquely simulated/sampled for each survey
  + Random order of lineups on survey
  + Random plot ordering within lineups
  + Permutation step for each plot construction

--
<br>

- 45 participants 
  + 24 Undergrad, 14 Grad, 6 Faculty, 1 Unknown
  + 41 completed all eight lineups 

---
class: center, middle

# Results

---
### 1. Does the TT lineup have discriminative power in practice?

```{r, echo=FALSE, warning=FALSE, message=FALSE, out.width=900, out.height==450, fig.align='left', cache=TRUE}
survey_dat_linear <- do.call(rbind,sim_data[c(7,2,1)]) %>%
  mutate(simtype = factor(simtype, levels=c("Independent-Normal","Weak Linear","Strong Linear")))

survey_dat <- do.call(rbind,sim_data[c(1,2,3,4,7,8)]) %>%
  mutate(simtype = factor(simtype, levels=c("Independent-Normal","Weak Linear","Strong Linear",
                                           "Independent-Uniform","Curved Weak","Curved Strong")))

p6 <- ggplot() +
  geom_point(aes(x,y,color=simtype), data=survey_dat) +
  facet_wrap(~simtype, nrow=2, scales = "free") +
  theme_bw()+
  theme(axis.ticks = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank(),
        panel.grid = element_blank(),
        panel.spacing = unit(1, "lines"),
        legend.position = "none") +
  scale_color_manual(values=c(rep("darkgoldenrod2",3),
                              rep("cyan4",3)))

ggsave(file="survey_data_strength_evidence.png",dpi=600,
       width=9, height=4.5,units="in")

knitr::include_graphics("survey_data_strength_evidence.png")
```

---
### 1. Does the TT lineup have discriminative power in practice? Yes!

```{r, echo=FALSE, warning=FALSE, message=FALSE, out.width=900, out.height==451, fig.cap="* t-test strongly suggests more correct answers than lower strength relationship", fig.align='left', cache=TRUE}

label_dat <- survey_dat %>%
  group_by(simtype) %>%
  summarize(x=mean(range(x)),
            y=mean(range(y))) %>%
  as.data.frame() %>%
  cbind(data.frame(label=paste0("Avg Correct = ",
                                     c("4.72","6.05*","7.55*","5.05","6.19*","7.31*"),
                                     "\nSd Correct = ",
                                     c("1.45","1.49","0.95","1.79","1.87","1.49"))))

p6.2 <- ggplot() +
  geom_point(aes(x,y,color=simtype), alpha=.1, data=survey_dat) +
  geom_text(aes(x=x,y=y,label=label,color=simtype),
            size=6,data=label_dat)+
  facet_wrap(~simtype, nrow=2, scales = "free") +
  theme_bw()+
  theme(axis.ticks = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank(),
        panel.grid = element_blank(),
        panel.spacing = unit(1, "lines"),
        legend.position = "none") +
  scale_color_manual(values=c(rep("darkgoldenrod2",3),
                              rep("cyan4",3)))

ggsave(file="survey_data_strength_evidence2.png",dpi=600,
       width=9, height=4.5,units="in")

knitr::include_graphics("survey_data_strength_evidence2.png")
```

---
### 2. Are the TT lineup p-values hypergeometrically distributed?

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=8, fig.height=4, cache=TRUE}
load("graph_df.Rdata")
# wide to tall, scale to density values, clean labels
tall_dat <- graph_df %>%
  gather(key="type",value="value",expected:observed_normal) %>%
  group_by(type) %>%
  mutate(density = value/sum(value)) %>%
  ungroup() %>%
  mutate(distn_type= factor(type,labels=c("Hypergeometric","Observed - Ind Normal","Observed - Ind Uniform")))

# set aside observed distributions under uniform and normal generated data
observed_distn <- filter(tall_dat,distn_type!="Hypergeometric")%>%
  mutate(facet_frame = distn_type)
# make a version of the HG distn that will overlay into each facet frame
baseline_distn <- rbind(filter(tall_dat,distn_type=="Hypergeometric"),
                        filter(tall_dat,distn_type=="Hypergeometric"))
baseline_distn$facet_frame <- observed_distn$facet_frame

# faceted version of empirical distributions
p7 <- ggplot() + 
  geom_bar(aes(x=x-.02, y=density, fill=distn_type, color=distn_type),
           size=.5,alpha=.7, stat="identity",
           data=baseline_distn)  + 
  geom_bar(aes(x=x+.02, y=density, fill=distn_type, color=distn_type),
           size=.5,alpha=.2, stat="identity", 
           data=observed_distn) +
  facet_grid(. ~ facet_frame ) +
  scale_fill_manual(values=c("gray80","red","blue")) +
  scale_color_manual(values=c("black","red","blue")) +
  labs(x="Number of Correct Responses",
       y="Probability Density",
       color=" ",fill=" ")+
  theme_bw()+
  theme(legend.position = "bottom")

ggsave(file="DensityComparisons.png",dpi=600,
       width=8, height=4,units="in")

knitr::include_graphics("DensityComparisons.png")
```

???

Chi Square tests for matched distribution reject the hypergeometric distribution with p-values < 0.001
---

### 2. Are the TT lineup p-values hypergeometrically distributed? No. 

<br> <br> 

This would be true, **assuming** that null plots and target plots are indistinguishable under the null

--

<br> <br> 

So why are target plots noticeably different?

---

### 2. Are the TT lineup p-values hypergeometrically distributed? No. Why not?
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=10,fig.height=7, cache=TRUE, fig.cap='Sometimes data from the null are "steriotypical"'}
#------------------------------------
### make plot building walkthrough with unif data
set.seed(12345)
exampleUnif1 <- data.frame(x=runif(50,-2,2),
                           y=runif(50,-2,2),
                           type="Original - Independent Uniform") 

exampleUnif2 <- exampleUnif1 %>%
  mutate(type="LOESS Fit then Residuals Permuted")  %>%
  mutate(type = factor(type,levels=c("Original - Independent Uniform","LOESS Fit then Residuals Permuted","Target Plot")))

exampleUnif3 <- exampleUnif1 %>%
  make_alt_dat() %>%
  mutate(type="Target Plot",
         y=permy) %>%
  select(x,y,type)

exampleUnifAll<- rbind(exampleUnif1,exampleUnif2,exampleUnif3) %>%
  mutate(type = factor(type,levels=c("Original - Independent Uniform","LOESS Fit then Residuals Permuted","Target Plot")),
         plottype = "Target Plot Construction", 
         permx=NA,permy=NA)
exampleUnifAll$permx[exampleUnifAll$type == "LOESS Fit then Residuals Permuted"] <- exampleUnif3$x
exampleUnifAll$permy[exampleUnifAll$type == "LOESS Fit then Residuals Permuted"] <- exampleUnif3$y

p8 <- ggplot() +
  geom_point(aes(x=x,y=y), data=exampleUnifAll) +
  geom_segment(aes(x=x,y=y, xend=permx, yend=permy),data=exampleUnifAll,
               arrow = arrow(length = unit(0.2,"cm")), alpha=.2) +
  facet_grid(plottype~type, scales="free_x", switch="y") +
  scale_y_continuous(position = "right")+
  stat_smooth(aes(x=x,y=y), data=exampleUnif2, se=F) +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        strip.text = element_text(size=12))

ggsave(file="MakingUnifTargetPlots.png",dpi=600,
       width=10, height=5,units="in")

knitr::include_graphics("MakingUnifTargetPlots.png")
```

---
### 2. Are the TT lineup p-values hypergeometrically distributed? No. Why not?
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=10,fig.height=7, cache=TRUE, fig.cap='Sometimes data from the null are "weird" (type I errors)'}
#------------------------------------
### make plot building walkthrough with unif data
set.seed(12)
exampleUnif1 <- data.frame(x=runif(50,-2,2),
                           y=runif(50,-2,2),
                           type="Original - Independent Uniform") 

exampleUnif2 <- exampleUnif1 %>%
  mutate(type="LOESS Fit then Residuals Permuted")  %>%
  mutate(type = factor(type,levels=c("Original - Independent Uniform","LOESS Fit then Residuals Permuted","Target Plot")))

set.seed(5)
exampleUnif3 <- exampleUnif1 %>%
  make_alt_dat() %>%
  mutate(type="Target Plot",
         y=permy) %>%
  select(x,y,type)

exampleUnifAll<- rbind(exampleUnif1,exampleUnif2,exampleUnif3) %>%
  mutate(type = factor(type,levels=c("Original - Independent Uniform","LOESS Fit then Residuals Permuted","Target Plot")),
         plottype = "Target Plot Construction", 
         permx=NA,permy=NA)
exampleUnifAll$permx[exampleUnifAll$type == "LOESS Fit then Residuals Permuted"] <- exampleUnif3$x
exampleUnifAll$permy[exampleUnifAll$type == "LOESS Fit then Residuals Permuted"] <- exampleUnif3$y

p8.3 <- ggplot() +
  geom_point(aes(x=x,y=y), data=exampleUnifAll) +
  geom_segment(aes(x=x,y=y, xend=permx, yend=permy),data=exampleUnifAll,
               arrow = arrow(length = unit(0.2,"cm")), alpha=.2) +
  facet_grid(plottype~type, scales="free_x", switch="y") +
  scale_y_continuous(position = "right")+
  stat_smooth(aes(x=x,y=y), data=exampleUnif2, se=F) +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        strip.text = element_text(size=12))

ggsave(file="MakingUnifTargetPlots3.png",dpi=600,
       width=10, height=5,units="in")

knitr::include_graphics("MakingUnifTargetPlots3.png")

```

---
### 2. Are the TT lineup p-values hypergeometrically distributed? No. Why not?
```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.align='center', fig.width=10,fig.height=7, cache=TRUE, fig.cap='Sometimes data from the null are "steriotypical", but our method are unstable'}
#------------------------------------
### make plot building walkthrough with unif data
set.seed(1234)
exampleUnif1 <- data.frame(x=runif(50,-2,2),
                           y=runif(50,-2,2),
                           type="Original - Independent Uniform") 

exampleUnif2 <- exampleUnif1 %>%
  mutate(type="LOESS Fit then Residuals Permuted")  %>%
  mutate(type = factor(type,levels=c("Original - Independent Uniform","LOESS Fit then Residuals Permuted","Target Plot")))

exampleUnif3 <- exampleUnif1 %>%
  make_alt_dat() %>%
  mutate(type="Target Plot",
         y=permy) %>%
  select(x,y,type)

exampleUnifAll<- rbind(exampleUnif1,exampleUnif2,exampleUnif3) %>%
  mutate(type = factor(type,levels=c("Original - Independent Uniform","LOESS Fit then Residuals Permuted","Target Plot")),
         plottype = "Target Plot Construction", 
         permx=NA,permy=NA)
exampleUnifAll$permx[exampleUnifAll$type == "LOESS Fit then Residuals Permuted"] <- exampleUnif3$x
exampleUnifAll$permy[exampleUnifAll$type == "LOESS Fit then Residuals Permuted"] <- exampleUnif3$y

p8.2 <- ggplot() +
  geom_point(aes(x=x,y=y), data=exampleUnifAll) +
  geom_segment(aes(x=x,y=y, xend=permx, yend=permy),data=exampleUnifAll,
               arrow = arrow(length = unit(0.2,"cm")), alpha=.2) +
  facet_grid(plottype~type, scales="free_x", switch="y") +
  scale_y_continuous(position = "right")+
  stat_smooth(aes(x=x,y=y), data=exampleUnif2, se=F) +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        strip.text = element_text(size=12))

ggsave(file="MakingUnifTargetPlots2.png",dpi=600,
       width=10, height=5,units="in")

knitr::include_graphics("MakingUnifTargetPlots2.png")

```

---
class: center, middle

# Conclusions

---


### What did we learn? 

1. Does the TT lineup have discriminative power in practice?
<br><br>
*Yes*, more correct guesses for data with stronger relationship 
<br><br>

2. Are correct guess counts hypergeometrically distributed for a true null? 
<br><br>
*No*, issues with LOESS tail-instability.
<br><br>
Should consider alternative methods for generating target plots
(wider smoothing span/subsampling/bootstrapping)
  
--
  
### Implementation

- R package implementation is available at [github.com/kmaurer/teaTasteR](https://github.com/kmaurer/teaTasteR)
```{r, eval=FALSE}
devtools::install_github("kmaurer/teaTasteR")
```

---

### References

#### Literature

- Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E. K., Swayne, D. F., & Wickham, H. (2009). Statistical inference for exploratory data analysis and model diagnostics. Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences, 367(1906), 4361-4383.
- Chowdhury, N. R., Cook, D., Hofmann, H., Majumder, M., Lee, E. K., & Toth, A. L. (2015). Using visual statistical inference to better understand random class separations in high dimension, low sample size data. Computational Statistics, 30(2), 293-316.
- Fisher, R. A. (1960). The design of experiments. The design of experiments., (7th Ed).
- Hofmann, H., Follett, L., Majumder, M., & Cook, D. (2012). Graphical tests for power comparison of competing designs. IEEE Transactions on Visualization and Computer Graphics, 18(12), 2441-2448.
- Majumder, M., Hofmann, H., & Cook, D. (2013). Validation of visual statistical inference, applied to linear models. Journal of the American Statistical Association, 108(503), 942-956.
- VanderPlas, S., & Hofmann, H. (2017). Clusters beat Trend!? Testing feature hierarchy in statistical graphics. Journal of Computational and Graphical Statistics, 26(2), 231-242.
-Zhao, Y., Cook, D., Hofmann, H., Majumder, M., & Chowdhury, N. R. (2013). Mind Reading: Using an Eye-Tracker to See How People are Looking at Lineups. International Journal of Intelligent Technologies & Applied Statistics, 6(4).

---

### References

#### Software and Data

- Azzalini, A. and Bowman, A. W. (1990). A look at some data on the Old Faithful geyser. Applied Statistics, 39, 357–365. doi: 10.2307/2347385.
- Genz, Bretz, Miwa, Mi, Leisch, Scheipl, Hothorn (2019). mvtnorm: Multivariate Normal and t Distributions. R package version 1.0-10. URL http://CRAN.R-project.org/package=mvtnorm 
- R Core Team, 2019. R: A language and environment for statistical computing. 
- R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.
- RStudio Team (2016). RStudio: Integrated Development for R. RStudio,
  Inc., Boston, MA URL http://www.rstudio.com/.
- Wickham, 2019. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016.
- Xie (2019). knitr: A General-Purpose Package for Dynamic Report Generation in R. R package version 1.22.
---


class: center, middle

# Thanks!

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).

