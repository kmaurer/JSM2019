---
title: "Lady Tasting Tea Lineups"
author: "Karsten Maurer"
# institute: "Miami University"
date: "July 31, 2019"
output:
  xaringan::moon_reader:
    css: [default, "Miami_theme.css"]
    lib_dir: libs
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

### Lady Tasting Tea <sup>1</sup>

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(teaTasteR)
```


```{r, out.width = "320px", echo=FALSE}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/thumb/3/37/Nice_Cup_of_Tea.jpg/1280px-Nice_Cup_of_Tea.jpg")
```

.footnote[
[1] Fisher, R. A. (1960)


- Ronald Fisher and Muriel Bristol working at Rothamsted

- Claimed she could tell if tea or milk added first

--
- Blind taste test: four milk first, four tea first

- Fisher's Exact Test  $\rightarrow$ follows hypergeometric if guessing


???

Image credit: [Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Sharingan_triple.svg)

---

### Lineups 

```{r, echo=FALSE, fig.align='center', out.height=380, fig.cap='Can the witness pick the criminal out of a randomized lineup of people?'}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/0/04/Oppstilling-2.jpg")
```

???

Image credit: [Wikimedia Commons](https://upload.wikimedia.org/wikipedia/commons/0/04/Oppstilling-2.jpg)


---

### Lineups (for Visual Inference) <sup>2</sup>

.footnote[
[2] Buja, A., Cook, D., Hofmann, H., Lawrence, M., Lee, E. K., Swayne, D. F., & Wickham, H. (2009)
]


```{r, echo=FALSE, fig.align='center', fig.width=9, fig.height=6, out.height=380,out.width=570,  cache=TRUE, fig.cap='Can the statistician pick the real data out of a randomized lineup of data simulated under the null?'}
set.seed(12345)
M=19
diamond_samp <- sample_n(diamonds,500)
order_types = sample(c(rep("null",  M),"real"), M+1)
dat_stacked = NULL
    for (i in 1:(M+1)) {
        if (order_types[i] == "null"){
          dat_i = make_null_dat(dat=diamond_samp,xname = "carat",yname="price")
        }  
        if (order_types[i] == "real"){
          dat_i = data.frame(x=diamond_samp$carat,
                             permy=diamond_samp$price,
                             type="real")
        } 
        dat_i$order = i
        dat_stacked = rbind(dat_stacked, dat_i)
    }   
tt_lineup_plot(dat_stacked) +
  theme(panel.spacing = unit(.2, "lines"),
        strip.text=element_text(size=14))
```
---

### Lineups (for Visual Inference)


- Plot of real data hidden in set of K-1 plots of data generated under null model
<br><br>

--
#### Lineup Interpretations - One Viewer

- If a viewer can pick out the real data (p-value=1/K) $\rightarrow$ reject the null

- If a viewer can't pick out the real data (p-value=1) $\rightarrow$ fail to reject the null
<br><br>

--
#### Lineup Interpretations - Many Viewers

- Each person attempts to pick out real data

- Sum of correct guesses distributed Binomial(n,1/K) if viewers independent

---

### Our Work

- Research Team: George Woodbury, Seonjin Kim and myself

- Work started with George's masters project improving visual inference with one person

- After masters, George came back with a new idea...

-- 
#### Mashup: Tea Tasting + Lineup Plots

- 


---



# Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r}
knitr::kable(head(iris), format = 'html')
```


---

class: center, middle

# Thanks!

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
